{% ckan_extends %}
{% set current_lang = request.environ.CKAN_LANG %}

{% block header_account_logged %}
{% set governance_organizations = h.organizations_available(permission='governance') %}
<div class="panel-row">
  <p class="fw-600"><span class="font-01">{{ _("Font size") }}</span></p>
  <div class="options">
    <a class="option btn font-size-btn" data-size="normal">
      <span style="font-size:14px;">{{ _("A") }}</span>
    </a>
    <a class="option btn font-size-btn" data-size="smaller">
      <span style="font-size:16px;">{{ _("A") }}</span>
    </a>
    <a class="option btn font-size-btn" data-size="larger">
      <span style="font-size:20px;">{{ _("A") }}</span>
    </a>
  </div>
</div>
<li>
  <a href="{% url_for h.current_url(), locale='th' %}" class="image lang {% if 'th' == current_lang %}active{% endif %}"
    title="th">
    <img src="{{ h.url_for_static('/base/logo_mea_opendata/th.png') }}" class="user-image" width="22" height="22"
      alt="Gravatar">
  </a>
  <a href="{% url_for h.current_url(), locale='en' %}" class="image lang {% if 'en' == current_lang %}active{% endif %}"
    title="en">
    <img src="{{ h.url_for_static('/base/logo_mea_opendata/en.png') }}" class="user-image" width="22" height="22"
      alt="Gravatar">
  </a>
</li>
{% if h.check_access('steward') %}
<li>
  <a href="{{ h.url_for('/governance/processing_state') }}" title="{{ _('Data Governance') }}">
    <i class="fa fa-cogs" aria-hidden="true"></i>
    <span class="text">{{ _('Data Governance') }}</span>
  </a>
</li>
{% elif governance_organizations | length %}
<li>
  <a href="{{ h.url_for('/governance/processing_state') }}" title="{{ _('Data Governance') }}">
    <i class="fa fa-cogs" aria-hidden="true"></i>
    <span class="text">{{ _('Data Governance') }}</span>
  </a>
</li>
{% endif %}
{{ super() }}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Store the original font sizes
    const elements = document.querySelectorAll('body, h1, h2, h3, h4, h5, h6, p, a');
    elements.forEach(element => {
      element.setAttribute('data-original-size', window.getComputedStyle(element).fontSize);
    });
  
    // Load saved font size setting from localStorage
    const savedFontSize = localStorage.getItem('fontSize');
    if (savedFontSize) {
      adjustFontSize(savedFontSize);
      document.querySelectorAll('.font-size-btn').forEach(button => {
        if (button.getAttribute('data-size') === savedFontSize) {
          button.classList.add('active');
        }
      });
    }
  
    // Add event listeners to font size buttons
    document.querySelectorAll('.font-size-btn').forEach(button => {
      button.addEventListener('click', function () {
        // Remove active class from all buttons
        document.querySelectorAll('.font-size-btn').forEach(btn => btn.classList.remove('active'));
        // Add active class to the clicked button
        this.classList.add('active');
  
        // Adjust font size and save setting
        const size = this.getAttribute('data-size');
        adjustFontSize(size);
        localStorage.setItem('fontSize', size);
      });
    });
  
    function adjustFontSize(size) {
      elements.forEach(element => {
        const originalFontSize = parseInt(element.getAttribute('data-original-size'));
        if (size === 'smaller') {
          element.style.fontSize = (originalFontSize + 2) + 'px';
        } else if (size === 'larger') {
          element.style.fontSize = (originalFontSize + 4) + 'px';
        } else {
          // Reset to original font size
          element.style.fontSize = '';
        }
      });
    }
  });
</script>
{% endblock %}

{% block header_account_notlogged %}
<div class="panel-row">
  <p class="fw-600"><span class="font-01">{{ _("Font size") }}</span></p>
  <div class="options">
    <a class="option btn font-size-btn" data-size="normal">
      <span style="font-size:14px;">{{ _("A") }}</span>
    </a>
    <a class="option btn font-size-btn" data-size="smaller">
      <span style="font-size:16px;">{{ _("A") }}</span>
    </a>
    <a class="option btn font-size-btn" data-size="larger">
      <span style="font-size:20px;">{{ _("A") }}</span>
    </a>
  </div>
</div>
<li>
  <a href="{% url_for h.current_url(), locale='th' %}" class="image lang {% if 'th' == current_lang %}active{% endif %}"
    title="th">
    <img src="{{ h.url_for_static('/base/logo_mea_opendata/th.png') }}" class="user-image" width="22" height="22"
      alt="Gravatar">
  </a>
  <a href="{% url_for h.current_url(), locale='en' %}" class="image lang {% if 'en' == current_lang %}active{% endif %}"
    title="en">
    <img src="{{ h.url_for_static('/base/logo_mea_opendata/en.png') }}" class="user-image" width="22" height="22"
      alt="Gravatar">
  </a>
</li>
{{ super() }}


<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Store the original font sizes
    const elements = document.querySelectorAll('body, h1, h2, h3, h4, h5, h6, p, a');
    elements.forEach(element => {
      element.setAttribute('data-original-size', window.getComputedStyle(element).fontSize);
    });
  
    // Load saved font size setting from localStorage
    const savedFontSize = localStorage.getItem('fontSize');
    if (savedFontSize) {
      adjustFontSize(savedFontSize);
      document.querySelectorAll('.font-size-btn').forEach(button => {
        if (button.getAttribute('data-size') === savedFontSize) {
          button.classList.add('active');
        }
      });
    }
  
    // Add event listeners to font size buttons
    document.querySelectorAll('.font-size-btn').forEach(button => {
      button.addEventListener('click', function () {
        // Remove active class from all buttons
        document.querySelectorAll('.font-size-btn').forEach(btn => btn.classList.remove('active'));
        // Add active class to the clicked button
        this.classList.add('active');
  
        // Adjust font size and save setting
        const size = this.getAttribute('data-size');
        adjustFontSize(size);
        localStorage.setItem('fontSize', size);
      });
    });
  
    function adjustFontSize(size) {
      elements.forEach(element => {
        const originalFontSize = parseInt(element.getAttribute('data-original-size'));
        if (size === 'smaller') {
          element.style.fontSize = (originalFontSize + 2) + 'px';
        } else if (size === 'larger') {
          element.style.fontSize = (originalFontSize + 4) + 'px';
        } else {
          // Reset to original font size
          element.style.fontSize = '';
        }
      });
    }
  });
</script>
{% endblock %}